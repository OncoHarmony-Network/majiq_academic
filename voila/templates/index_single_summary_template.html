{% extends "index_summary_template.html" %}

{% block header %}
    LSV &Psi; Index: {{ lexps.group1 }}
{% endblock %}


{% block tableContent %}

    <thead>
    <tr>
        <th class="extra-short-header">#</th>
        <th class="short-header">Gene</th>
        <th class="short-header">LSV ID</th>
        <th class="short-header">LSV Type</th>
        <th>&Psi; per Junction</th>
        <th class="medium-header">Coordinates Links</th>
    </tr>
    </thead>
    <tfoot>
    <tr>
        <th>#</th>
        <th>Gene</th>
        <th>LSV ID</th>
        <th>LSV Type</th>
        <th>&Psi; per Junction</th>
        <th>Coordinates Links</th>
    </tr>
    </tfoot>
    <tbody>
    {% for lsv in lsvList -%}
        <tr class="{{ lsv.categories2css() }} lsvrow" data-njuncs="{{ lsv.njuncs() }}" data-nexons="{{ lsv.nexons() }}">
            <td>{{ loop.index }}</td>
            <td><a href="{{ links_dict[lsv.lsv_graphic.name] }}#{{ lsv.lsv_graphic.name }}"
                   target="_blank">{{ lsv.lsv_graphic.name }}</a></td>
            <td><a href="{{ links_dict[lsv.lsv_graphic.name] }}#{{ lsv.lsv_graphic.name }}"
                   target="_blank">{{ lsv.lsv_graphic.gene_id }}</a></td>
            {% if lsvList|length > maxLsvs -%}
                <td class="medium-header text-wrapped">
                    {{ lsv.get_type() }}
                </td>
                <td id="data_td{{ loop.index }}" class="medium-header text-wrapped">
                <span class="hidden">
                    {% set max_diff = [0.0] %}
                    {% for mean_b in lsv.get_means() %}
                        {% if mean_b > max_diff[-1] %}
                            {% do max_diff.append(mean_b) %}
                        {% endif %}
                    {%- endfor %}
                    {{ max_diff[-1]|round(4) }}
                </span>
                    {{ lsv.get_means() }}
                </td>
            {% else %}
                <td>
                    <p class="hidden" style="top:0;">{{ lsv.lsv_type }}</p>
                    <canvas class="lsvLegend" width="200px" height="60px" data-lsv-string="{{ lsv.lsv_graphic.lsv_type }}"
                            title="{{ lsv.lsv_type }}">
                        This browser or document mode doesn't support canvas
                    </canvas>
                </td>
                <td id="data_td{{ loop.index }}">
                <span class="hidden">
                    {% set max_diff = [0.0] %}
                    {% for mean_b in lsv.means %}
                        {% if mean_b > max_diff[-1] %}
                            {% do max_diff.append(mean_b) %}
                        {% endif %}
                    {%- endfor %}
                    {{ max_diff[-1]|round(4) }}
                </span>
                    <canvas class="lsvSingleCompactPercentiles" id="lsvSingleCompact{{ loop.index }}" width="50px"
                            height="50px" style="border: solid; border-width: 2pt; border-color: darkgrey;"
                            data-lsv="[{{ lsv|to_json }}]">
                        This browser or document mode doesn't support canvas
                    </canvas>
                </td>
            {% endif -%}
            <td>
                <p>
                    <a href="http://genome.ucsc.edu/cgi-bin/hgTracks?db={{ lexps.genome }}&position={{ lsv.lsv_graphic.chromosome }}:{{ lsv.get_extension()[0] }}-{{ lsv.get_extension()[1] }}"
                       target="_blank">
                        <img src="static/img/icons/ucsc3.png" title="View in UCSC Genome Browser"/>
                    </a>
                </p>
            </td>

        </tr>
    {%- endfor %}
    </tbody>
{% endblock %}


