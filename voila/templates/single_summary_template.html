{% extends "base_template.html" %}
{% block title %}MAJIQ &Psi; Summary{% endblock %}
{% block css %}
    {# Evaluate if we should divide different css in files #}

{% endblock %}

{% block js %}
    <script src="../templates/static/js/jquery-1.10.2.js" type="text/javascript"></script>
    <script src="../templates/static/js/jquery.tablesorter.js" type="text/javascript"></script>
    <script src="../templates/static/js/jquery.tablesorter.pager.js" type="text/javascript"></script>
    <script src="../templates/static/js/jquery.mousewheel.js" type="text/javascript"></script>
    <script src="../templates/static/js/application.js" type="text/javascript"></script>
{% endblock %}

{% block content %}
    <div class="descriptive_summary">
        <h1>&Psi; Summary<button class='hideshow_extended hidden'>Extended info</button></h1>
        <!--<h2>Execution information</h2>-->
        <!--<p><i>TODO: Inputs: information about data provided to majiq and its execution (resources used like memory, CPU,..).</i></p>-->
        {% if metadata %}
            <ul>
                <li>Genome: {{ metadata.genome }}</li>
                <li>File: {{ metadata.file }}</li>
            </ul>
        {% endif %}
        <h2>Stats summary</h2>
        <ul>
            <!--<li>-->
                <!--GC Content-->
                <!--<input type="image" class="gcContent" src="../templates/static/img/zoom_in.png" alt="GC Content"-->
                       <!--data-gc-src="../templates/static/img/test_plot.png" border="0">-->
            <!--</li>-->
            <li>Number of exons: 12</li>
            <li>Type of events: {Exon Skipping}</li>
            {% if metadata %}
                <li>Number of reads: {{ metadata.num_reads }}</li>
            {% endif %}
        </ul>

        <!--<h2>Screened out elements</h2>-->
        <!--<ul>-->
            <!--<li>Number of stacks filtered out</li>-->
            <!--<li>Number of non-unique stacks</li>-->
            <!--<li>Number of non-unique positions</li>-->
            <!--<li>etc.</li>-->
        <!--</ul>-->

        <div class="extended-info hidden">
        <ul>
            <li>GC content profile</li>
            <li>Position bias</li>
            <li>&mu; and &sigma; plots</li>
            <li>P-val fit</li>
            <li>Distributions of: numbers of reads and positions per junction</li>
        </ul>
        </div> {#toggable div for extended information #}
    </div>
    <div class="events-summary">
        <h1>Events summary</h1>
        <h2>Table containing event information</h2>

        {# It will look something like this #}
        <table id="event_table" class="tablesorter">
            <thead>
            <tr>
                <th class="short-header">#</th>
                <th class="short-header">Event ID</th>
                <th class="medium-header">Type</th>
                <th class="mean-header">mean(&Psi;)</th>
                <th class="large-header">PDF of &Psi;</th>
                <th class="short-header">Coordinates</th>
            </tr>
            </thead>
            <tfoot>
            <tr>
                <th>#</th>
                <th>Event ID</th>
                <th>Type</th>
                <th>mean(&Psi;)</th>
                <th>
                    <canvas class="large-header legendCanvas" width="420px" height="25px">
                        This browser or document mode doesn't support canvas
                    </canvas>
                </th>
                <th>Coordinates</th>
            </tr>
            </tfoot>
            <tbody>
            {% for event in eventList  -%}
                <tr>
                    <td>{{ event.number }}</td>
                    <td>{{ event.id }}</td>
                    <td>{{ event.type }}</td>
                    <td>{{ event.mean_psi|round(4) }}</td>
                    <td>
                        <canvas id="psiExtendedPlot{{ event.number }}" class="largePsiPlot hidden" width="419px" height="300px"
                                    mean_psi="{{ event.mean_psi}}" conf_interval="{{ event.conf_interval }}" >
                                This browser or document mode doesn't support canvas
                        </canvas>
                        <canvas id="psiPlot{{ event.number }}" class="psiPlot" width="400px" height="20px"
                                mean_psi="{{ event.mean_psi}}" conf_interval="{{ event.conf_interval }}"
                                quartiles="{{ event.quartiles }}"
                                bins="{{ event.bins }}">
                            This browser or document mode doesn't support canvas
                        </canvas>
                        <img class="detailedPsiLink" id="detailedPsi{{ event.number }}" src="../templates/static/img/arrow_down.png" isExpanded=0 title="Detailed PDF barchart"/>

                    </td>
                    <td>{{ event.coords }}</td> {# TODO: here there should be a link to UCSC browser or similar #}
                </tr>
            {%- endfor %}
            </tbody>
        </table>
        <div class="pager">
            <form>
                <img src="../templates/static/img/icons/first.png" class="first"/>
                <img src="../templates/static/img/icons/prev.png" class="prev"/>
                <input type="text" class="pagedisplay"/>
                <img src="../templates/static/img/icons/next.png" class="next"/>
                <img src="../templates/static/img/icons/last.png" class="last"/>
                <select class="pagesize" autocomplete="off">
                    {% for mark in tableMarks -%}
                        {% if loop.first %}
                            <option selected="selected"  value="{{ mark }}">{{ mark }}</option>
                        {% else %}
                            <option value="{{ mark }}">{{ mark }}</option>
                        {% endif %}
                    {%- endfor %}
                    <option value="{{ eventList|length }}">All</option>
                </select>
            </form>
        </div>
    </div>
{% endblock %}

